# Ambient Mode

### Sidecar

사이드카 모드는 어플리케이션 코드에 침투하지 않는다는 장점이 있지만, 배포된 파드의 일정 리소스를 예약해야 해서 성능 문제가 발생 가능하다는 단점이 있다.
또한 업데이트를 위해서는 파드를 재배포 해야 한다. 또한 모든 워크로드가 L7 레이어의 복잡한 기능을 포함하지 않아도 되지만, 사이드카 모드에서는 L7 레이어 기능 사용 여부를
선택할 수 없다.

### Ambient Mode

앰비언트 모드는 L4 레이어와 L7 레이어 기능을 선택적으로 적용 가능하다. 앰비언트 메시는 노드 단위의 공유 리소스인 ztunnel을 제공한다. 이 리소스를 통해서 mTLS를 처리한다. 
파드에 사이드카가 Injection 되는 형태가 아니기 때문에 Pod의 리소스와는 완전 분리된다. L4 까지의 기능만 원할때는 Secure overlay로써 L4 Traffic Routing과 mTLS 처리 정도만 지원한다.

만약 L7 처리를 원하는 네임스페이스에서는 하나 이상의 Envoy 기반 웨이포인트 프록시 처리한다. 이때 특정 로컬 노드가 아닌 공유 네임스페이스 리소스를 사용해 웨이포인트 프록시를 배포한다. 웨이포인트 프록시는
일반적인 쿠버네티스 Pod이기 때문에 동적인 확장도 가능하다.

로컬 노드에서 수행되지 않음으로써 발생 가능한 Network Hop 지연은 거의 없다. 기존에는 L7 처리를 클라이언트와 서버 각각의 사이드카에서 2번 처리해야했지만, 웨이포인트 프록시를 사용해서 1번만 처리하면 되기 때문에
속도 차이의 거의 없다고 볼 수 있다.
