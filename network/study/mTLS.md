## mTLS

기존의 TLS 방식은 서버 측에만 TLS 인증서를 보관하고 클라이언트가 서버로부터 TLS 인증서를 받아 확인함으로써 신뢰성 있는 통신을 보장한다.
하지만 더 신뢰성 있는 통신을 위해서는 클라이언트도 검증해야 한다는 필요성이 생겼고, 클라이언트와 서버 모두가 TLS 인증서를 통해 서로를 인증하는 **mTLS** 방식이 생겨났다.
제로 트러스트 환경이 강조되면서 클라이언트가 본인을 검증된 사용자라는걸 증명할 필요가 생겼다.
mTLS에서는 클라이언트와 서버 모두에 인증서가 있고 양측 모두 공개/개인 키 쌍을 사용하여 인증한다. 일반 TLS와 비교하여 mTLS에는 양 당사자를 확인하기 위한 추가 단계가 있다.

1. 클라이언트가 서버에 연결
2. 서버가 TLS 인증서를 제시
3. 클라이언트가 서버의 인증서를 확인
4. 클라이언트가 TLS 인증서를 제시
5. 서버가 클라이언트의 인증서를 확인
6. 서버가 액세스 권한을 부여
7. 클라이언트와 서버가 암호화된 TLS 연결을 통해 정보를 교환

<img width="693" alt="스크린샷 2024-04-29 오후 3 57 19" src="https://github.com/CMC11th-Melly/Melly_Server/assets/82302520/a7040633-e2b5-4942-b7de-8fe6b5b524a1">

### 만약 클라이언트와 서버 사이에 WAF가 있다면?
보통 클라이언트와 서버 사이에 WAF가 들어오고, WAF가 클라이언트의 인증서를 검증한다. 서버는 WAF의 인증서를 검증
근데 WAF 통하면 서버가 클라이언트 식별 가능한가? 이때는 클라이언트 정보를 프록시 헤더에 넣어서 서버로 넘겨주면 식별 가능이다.

기존 TLS의 경우에는 클라이언트가 서버에 요청을 하면, 서버는 TLS 인증서를 클라이언트에게 전송해주고, 클라이언트가 확인한 뒤, 암호화된 연결을 통해서 정보 교환한다




